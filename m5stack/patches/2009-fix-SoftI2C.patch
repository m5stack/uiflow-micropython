Index: M5Unified/src/utility/IOExpander_Base.hpp
===================================================================
--- M5Unified.orig/src/utility/IOExpander_Base.hpp
+++ M5Unified/src/utility/IOExpander_Base.hpp
@@ -12,22 +12,12 @@
 
 namespace m5
 {
-
-#if CONFIG_IDF_TARGET_ESP32C6
-  class IOExpander_Base : public SoftI2C_Device
-  {
-  public:
-    IOExpander_Base(std::uint8_t i2c_addr, std::uint32_t freq = 400000, m5::SoftI2C_Class* i2c = &m5::In_SoftI2C)
-      : SoftI2C_Device(i2c_addr, freq, i2c)
-    {}
-#else
   class IOExpander_Base : public I2C_Device
   {
   public:
     IOExpander_Base(std::uint8_t i2c_addr, std::uint32_t freq = 400000, m5::I2C_Class* i2c = &m5::In_I2C)
       : I2C_Device(i2c_addr, freq, i2c)
     {}
-#endif
     IOExpander_Base(const IOExpander_Base&) = delete;
 
     // false input, true output
Index: M5Unified/src/utility/PI4IOE5V6408_Class.hpp
===================================================================
--- M5Unified.orig/src/utility/PI4IOE5V6408_Class.hpp
+++ M5Unified/src/utility/PI4IOE5V6408_Class.hpp
@@ -26,15 +26,10 @@ namespace m5
   {
   public:
     static constexpr std::uint8_t DEFAULT_ADDRESS = 0x43;
-#if CONFIG_IDF_TARGET_ESP32C6
-    PI4IOE5V6408_Class(std::uint8_t i2c_addr = DEFAULT_ADDRESS, std::uint32_t freq = 400000, m5::SoftI2C_Class* i2c = &m5::In_SoftI2C)
-    : IOExpander_Base(i2c_addr, freq, i2c)
-    {}
-#else
+
     PI4IOE5V6408_Class(std::uint8_t i2c_addr = DEFAULT_ADDRESS, std::uint32_t freq = 400000, m5::I2C_Class* i2c = &m5::In_I2C)
     : IOExpander_Base(i2c_addr, freq, i2c)
     {}
-#endif
 
     bool begin();
 
Index: M5Unified/src/utility/SoftI2C_Class.hpp
===================================================================
--- M5Unified.orig/src/utility/SoftI2C_Class.hpp
+++ M5Unified/src/utility/SoftI2C_Class.hpp
@@ -7,10 +7,11 @@
 #include <driver/gpio.h>
 #include <cstdint>
 #include <cstddef>
+#include "I2C_Class.hpp"
 
 namespace m5
 {
-  class SoftI2C_Class
+  class SoftI2C_Class : public I2C_Class
   {
   public:
     /// Constructor
@@ -22,55 +23,55 @@ namespace m5
     /// setup I2C pin parameters. (No begin)
     /// @param pin_sda SDA pin number.
     /// @param pin_scl SCL pin number.
-    void setPins(int pin_sda, int pin_scl);
+  void setPins(int pin_sda, int pin_scl);
 
     /// setup and begin I2C peripheral. (No communication is performed.)
     /// @param pin_sda SDA pin number.
     /// @param pin_scl SCL pin number.
     /// @return success(true) or failed(false).
-    bool begin(int pin_sda, int pin_scl);
+  bool begin(i2c_port_t port_num, int pin_sda, int pin_scl) override;
 
     /// begin I2C peripheral. (No communication is performed.)
     /// @return success(true) or failed(false).
-    bool begin(void);
+  bool begin(void) override;
 
     /// release I2C peripheral.
     /// @return success(true) or failed(false).
-    bool release(void) const;
+  bool release(void) const override;
 
     /// Sends the I2C start condition and the address of the slave.
     /// @param address slave addr.
     /// @param read bit of read flag. true=read / false=write.
     /// @return success(true) or failed(false).
-    bool start(std::uint8_t address, bool read, std::uint32_t freq) const;
+  bool start(std::uint8_t address, bool read, std::uint32_t freq) const override;
 
     /// Sends the I2C repeated start condition and the address of the slave.
     /// @param address slave addr.
     /// @param read bit of read flag. true=read / false=write.
     /// @return success(true) or failed(false).
-    bool restart(std::uint8_t address, bool read, std::uint32_t freq) const;
+  bool restart(std::uint8_t address, bool read, std::uint32_t freq) const override;
 
     /// Sends the I2C stop condition.
     /// If an ACK error occurs, return false.
     /// @return success(true) or failed(false).
-    bool stop(void) const;
+  bool stop(void) const override;
 
     /// Send 1 byte of data.
     /// @param data write data.
     /// @return success(true) or failed(false).
-    bool write(std::uint8_t data) const;
+  bool write(std::uint8_t data) const override;
 
     /// Send multiple bytes of data.
     /// @param[in] data write data array.
     /// @param     length data array length.
     /// @return success(true) or failed(false).
-    bool write(const std::uint8_t* data, std::size_t length) const;
+  bool write(const std::uint8_t* data, std::size_t length) const override;
 
     /// Receive multiple bytes of data.
     /// @param[out] result read data array.
     /// @param      length data array length.
     /// @return success(true) or failed(false).
-    bool read(std::uint8_t* result, std::size_t length, bool last_nack = false) const;
+  bool read(std::uint8_t* result, std::size_t length, bool last_nack = false) const override;
 
     //----------
 
@@ -80,7 +81,7 @@ namespace m5
     /// @param[in] data write data array.
     /// @param     length data array length.
     /// @return success(true) or failed(false).
-    bool writeRegister(std::uint8_t address, std::uint8_t reg, const std::uint8_t* data, std::size_t length, std::uint32_t freq) const;
+  bool writeRegister(std::uint8_t address, std::uint8_t reg, const std::uint8_t* data, std::size_t length, std::uint32_t freq) const override;
 
     /// Read multiple bytes value from the register. Performs a series of communications from START to STOP.
     /// @param address slave addr.
@@ -88,34 +89,34 @@ namespace m5
     /// @param[out] result read data array.
     /// @param      length data array length.
     /// @return success(true) or failed(false).
-    bool readRegister(std::uint8_t address, std::uint8_t reg, std::uint8_t* result, std::size_t length, std::uint32_t freq) const;
+  bool readRegister(std::uint8_t address, std::uint8_t reg, std::uint8_t* result, std::size_t length, std::uint32_t freq) const override;
 
     /// Write a 1-byte value to the register. Performs a series of communications from START to STOP.
     /// @param address slave addr.
     /// @param reg     register number.
     /// @param data    write data.
     /// @return success(true) or failed(false).
-    bool writeRegister8(std::uint8_t address, std::uint8_t reg, std::uint8_t data, std::uint32_t freq) const;
+  bool writeRegister8(std::uint8_t address, std::uint8_t reg, std::uint8_t data, std::uint32_t freq) const override;
 
     /// Read a 1-byte value from the register. Performs a series of communications from START to STOP.
     /// @param address slave addr.
     /// @param reg     register number.
     /// @return read value.
-    std::uint8_t readRegister8(std::uint8_t address, std::uint8_t reg, std::uint32_t freq) const;
+  std::uint8_t readRegister8(std::uint8_t address, std::uint8_t reg, std::uint32_t freq) const override;
 
     /// Write a 1-byte value to the register by bit add operation. Performs a series of communications from START to STOP.
     /// @param address slave addr.
     /// @param reg     register number.
     /// @param data    add bit data.
     /// @return success(true) or failed(false).
-    bool bitOn(std::uint8_t address, std::uint8_t reg, std::uint8_t data, std::uint32_t freq) const;
+  bool bitOn(std::uint8_t address, std::uint8_t reg, std::uint8_t data, std::uint32_t freq) const override;
 
     /// Write a 1-byte value to the register by bit erase operation. Performs a series of communications from START to STOP.
     /// @param address slave addr.
     /// @param reg     register number.
     /// @param data    erase bit data.
     /// @return success(true) or failed(false).
-    bool bitOff(std::uint8_t address, std::uint8_t reg, std::uint8_t data, std::uint32_t freq) const;
+  bool bitOff(std::uint8_t address, std::uint8_t reg, std::uint8_t data, std::uint32_t freq) const override;
 
     /// execute I2C scan. (for 7bit address)
     /// @param[out] result data array needs 120 Bytes.
@@ -149,66 +150,6 @@ namespace m5
 
   /// for internal I2C device
   extern SoftI2C_Class In_SoftI2C;
-
-  class SoftI2C_Device
-  {
-  public:
-    SoftI2C_Device(std::uint8_t i2c_addr, std::uint32_t freq, SoftI2C_Class* i2c = &In_SoftI2C)
-    : _i2c   { i2c      }
-    , _freq  { freq     }
-    , _addr  { i2c_addr }
-    , _init  { false    }
-    {}
-
-    void setPort(SoftI2C_Class* i2c) { _i2c = i2c; }
-
-    void setClock(std::uint32_t freq) { _freq = freq; }
-
-    void setAddress(std::uint8_t i2c_addr) { _addr = i2c_addr; }
-
-    std::uint8_t getAddress(void) const { return _addr; }
-
-    bool writeRegister8(std::uint8_t reg, std::uint8_t data) const
-    {
-      return _i2c->writeRegister8(_addr, reg, data, _freq);
-    }
-
-    std::uint8_t readRegister8(std::uint8_t reg) const
-    {
-      return _i2c->readRegister8(_addr, reg, _freq);
-    }
-
-    bool writeRegister8Array(const std::uint8_t* reg_data_array, std::size_t length) const;
-
-    bool writeRegister(std::uint8_t reg, const std::uint8_t* data, std::size_t length) const
-    {
-      return _i2c->writeRegister(_addr, reg, data, length, _freq);
-    }
-
-    bool readRegister(std::uint8_t reg, std::uint8_t* result, std::size_t length) const
-    {
-      return _i2c->readRegister(_addr, reg, result, length, _freq);
-    }
-
-    bool bitOn(std::uint8_t reg, std::uint8_t bit) const
-    {
-      return _i2c->bitOn(_addr, reg, bit, _freq);
-    }
-
-    bool bitOff(std::uint8_t reg, std::uint8_t bit) const
-    {
-      return _i2c->bitOff(_addr, reg, bit, _freq);
-    }
-
-    bool isEnabled(void) const { return _init; }
-
-  protected:
-    SoftI2C_Class *_i2c;
-    std::uint32_t _freq;
-    std::uint8_t _addr;
-    bool _init;
-  };
-
 }
 
 #endif
Index: M5Unified/src/M5Unified.cpp
===================================================================
--- M5Unified.orig/src/M5Unified.cpp
+++ M5Unified/src/M5Unified.cpp
@@ -1383,8 +1383,8 @@ static constexpr const uint8_t _pin_tabl
 #elif defined (CONFIG_IDF_TARGET_ESP32C6)
     case board_t::board_M5UnitC6L:
       {
-        In_SoftI2C.begin(10, 8);
-        auto ioexp = new PI4IOE5V6408_Class(0x43);
+        In_SoftI2C.begin(I2C_NUM_0, 10, 8);
+        auto ioexp = new PI4IOE5V6408_Class(0x43, 400000, &In_SoftI2C);
         ioexp->begin();
         _io_expander[0].reset(ioexp);
         // user button(P0) input pullup 
Index: M5Unified/src/utility/SoftI2C_Class.cpp
===================================================================
--- M5Unified.orig/src/utility/SoftI2C_Class.cpp
+++ M5Unified/src/utility/SoftI2C_Class.cpp
@@ -30,7 +30,7 @@ namespace m5
     _pin_scl = pin_scl;
   }
 
-  bool SoftI2C_Class::begin(int pin_sda, int pin_scl)
+  bool SoftI2C_Class::begin(i2c_port_t port_num,int pin_sda, int pin_scl)
   {
     setPins(pin_sda, pin_scl);
     return begin();
@@ -450,30 +450,4 @@ namespace m5
     return ack;
   }
 
-  bool SoftI2C_Device::writeRegister8Array(const std::uint8_t* reg_data_array, std::size_t length) const
-  {
-    if (!_i2c || !reg_data_array || length == 0) {
-      return false;
-    }
-
-    if (!_i2c->start(_addr, false, _freq)) {
-      return false;
-    }
-
-    for (std::size_t i = 0; i < length; i += 2) {
-      if (i + 1 < length) {
-        if (!_i2c->write(reg_data_array[i])) {
-          _i2c->stop();
-          return false;
-        }
-        if (!_i2c->write(reg_data_array[i + 1])) {
-          _i2c->stop();
-          return false;
-        }
-      }
-    }
-
-    return _i2c->stop();
-  }
-
 } // namespace m5
\ No newline at end of file
Index: M5Unified/src/utility/I2C_Class.hpp
===================================================================
--- M5Unified.orig/src/utility/I2C_Class.hpp
+++ M5Unified/src/utility/I2C_Class.hpp
@@ -23,56 +23,56 @@ namespace m5
     /// @param port_num I2C number. (I2C_NUM_0 or I2C_NUM_1).
     /// @param pin_sda SDA pin number.
     /// @param pin_scl SCL pin number.
-    void setPort(i2c_port_t port_num, int pin_sda, int pin_scl);
+  virtual void setPort(i2c_port_t port_num, int pin_sda, int pin_scl);
 
     /// setup and begin I2C peripheral. (No communication is performed.)
     /// @param port_num I2C number. (I2C_NUM_0 or I2C_NUM_1).
     /// @param pin_sda SDA pin number.
     /// @param pin_scl SCL pin number.
     /// @return success(true) or failed(false).
-    bool begin(i2c_port_t port_num, int pin_sda, int pin_scl);
+  virtual bool begin(i2c_port_t port_num, int pin_sda, int pin_scl);
 
     /// begin I2C peripheral. (No communication is performed.)
     /// @return success(true) or failed(false).
-    bool begin(void);
+  virtual bool begin(void);
 
     /// release I2C peripheral.
     /// @return success(true) or failed(false).
-    bool release(void) const;
+  virtual bool release(void) const;
 
     /// Sends the I2C start condition and the address of the slave.
     /// @param address slave addr.
     /// @param read bit of read flag. true=read / false=write.
     /// @return success(true) or failed(false).
-    bool start(std::uint8_t address, bool read, std::uint32_t freq) const;
+  virtual bool start(std::uint8_t address, bool read, std::uint32_t freq) const;
 
     /// Sends the I2C repeated start condition and the address of the slave.
     /// @param address slave addr.
     /// @param read bit of read flag. true=read / false=write.
     /// @return success(true) or failed(false).
-    bool restart(std::uint8_t address, bool read, std::uint32_t freq) const;
+  virtual bool restart(std::uint8_t address, bool read, std::uint32_t freq) const;
 
     /// Sends the I2C stop condition.
     /// If an ACK error occurs, return false.
     /// @return success(true) or failed(false).
-    bool stop(void) const;
+  virtual bool stop(void) const;
 
     /// Send 1 byte of data.
     /// @param data write data.
     /// @return success(true) or failed(false).
-    bool write(std::uint8_t data) const;
+  virtual bool write(std::uint8_t data) const;
 
     /// Send multiple bytes of data.
     /// @param[in] data write data array.
     /// @param     length data array length.
     /// @return success(true) or failed(false).
-    bool write(const std::uint8_t* data, std::size_t length) const;
+  virtual bool write(const std::uint8_t* data, std::size_t length) const;
 
     /// Receive multiple bytes of data.
     /// @param[out] result read data array.
     /// @param      length data array length.
     /// @return success(true) or failed(false).
-    bool read(std::uint8_t* result, std::size_t length, bool last_nack = false) const;
+  virtual bool read(std::uint8_t* result, std::size_t length, bool last_nack = false) const;
 
     //----------
 
@@ -82,7 +82,7 @@ namespace m5
     /// @param[in] data write data array.
     /// @param     length data array length.
     /// @return success(true) or failed(false).
-    bool writeRegister(std::uint8_t address, std::uint8_t reg, const std::uint8_t* data, std::size_t length, std::uint32_t freq) const;
+  virtual bool writeRegister(std::uint8_t address, std::uint8_t reg, const std::uint8_t* data, std::size_t length, std::uint32_t freq) const;
 
     /// Read multiple bytes value from the register. Performs a series of communications from START to STOP.
     /// @param address slave addr.
@@ -90,34 +90,34 @@ namespace m5
     /// @param[out] result read data array.
     /// @param      length data array length.
     /// @return success(true) or failed(false).
-    bool readRegister(std::uint8_t address, std::uint8_t reg, std::uint8_t* result, std::size_t length, std::uint32_t freq) const;
+  virtual bool readRegister(std::uint8_t address, std::uint8_t reg, std::uint8_t* result, std::size_t length, std::uint32_t freq) const;
 
     /// Write a 1-byte value to the register. Performs a series of communications from START to STOP.
     /// @param address slave addr.
     /// @param reg     register number.
     /// @param data    write data.
     /// @return success(true) or failed(false).
-    bool writeRegister8(std::uint8_t address, std::uint8_t reg, std::uint8_t data, std::uint32_t freq) const;
+  virtual bool writeRegister8(std::uint8_t address, std::uint8_t reg, std::uint8_t data, std::uint32_t freq) const;
 
     /// Read a 1-byte value from the register. Performs a series of communications from START to STOP.
     /// @param address slave addr.
     /// @param reg     register number.
     /// @return read value.
-    std::uint8_t readRegister8(std::uint8_t address, std::uint8_t reg, std::uint32_t freq) const;
+  virtual std::uint8_t readRegister8(std::uint8_t address, std::uint8_t reg, std::uint32_t freq) const;
 
     /// Write a 1-byte value to the register by bit add operation. Performs a series of communications from START to STOP.
     /// @param address slave addr.
     /// @param reg     register number.
     /// @param data    add bit data.
     /// @return success(true) or failed(false).
-    bool bitOn(std::uint8_t address, std::uint8_t reg, std::uint8_t data, std::uint32_t freq) const;
+  virtual bool bitOn(std::uint8_t address, std::uint8_t reg, std::uint8_t data, std::uint32_t freq) const;
 
     /// Write a 1-byte value to the register by bit erase operation. Performs a series of communications from START to STOP.
     /// @param address slave addr.
     /// @param reg     register number.
     /// @param data    erase bit data.
     /// @return success(true) or failed(false).
-    bool bitOff(std::uint8_t address, std::uint8_t reg, std::uint8_t data, std::uint32_t freq) const;
+  virtual bool bitOff(std::uint8_t address, std::uint8_t reg, std::uint8_t data, std::uint32_t freq) const;
 
     /// execute I2C scan. (for 7bit address)
     /// @param[out] result data array needs 120 Bytes.
